# Weekly Report Skill

Orchestrates the full storyteller pipeline from raw data to published narrative.
One command runs the automated steps; Copilot handles the narrative craft in the middle.

## Full Pipeline

```
Raw data (Copilot sessions, git repos, notes, calendar, email)
    │
    ▼
[1] storyteller run          ← automated
    ├─ ingest     → output/ingested.json
    ├─ digest     → output/digest-{period}-{date}.md
    └─ prepare    → output/narrative-{period}-{date}.md
    │
    ▼
[2] Copilot Chat             ← you + AI
    └─ generate-narrative skill → final narrative markdown
    │
    ▼
[3] storyteller publish      ← automated
    └─ GitHub gist or repo
```

## Step 1 — Run the automated pipeline

```bash
# Full week (most common — run on Friday)
uv run storyteller run --period week

# Today only
uv run storyteller run --period day

# Specific week (use any date in that week)
uv run storyteller run --period week --date 2025-01-13

# Override data / output directories inline
uv run storyteller run --period week --data-dir ~/work/data --output-dir ~/work/output
```

This single command:
1. **Ingests** everything from `STORYTELLER_DATA_DIR` → `output/ingested.json`
2. **Digests** Copilot sessions + git commits for the period → `output/digest-week-{date}.md`
3. **Prepares** the full narrative context across all sources → `output/narrative-week-{date}.md`

At the end it prints the exact file to open next and the command to publish.

## Step 2 — Generate the narrative in Copilot Chat

Open `output/narrative-week-{date}.md` in Copilot Chat, then prompt:

> Read the narrative context above and write a weekly summary following the
> generate-narrative skill format.  Use the Topics from the activity digest
> (`output/digest-week-{date}.md`) to anchor the themes.

The storyteller agent will produce a markdown narrative with:
- **Overview** — one-paragraph arc of the week
- **By Theme** — work grouped by topic rather than chronologically
- **Key Accomplishments** — concrete deliverables
- **Looking Ahead** — inferred next steps

Save the narrative to a file (e.g. `output/narrative-week-{date}-final.md`).

## Step 3 — Publish

```bash
# Publish as a secret gist (default)
uv run storyteller publish output/narrative-week-{date}-final.md \
  --description "Week of {date}"

# Publish to a repo
uv run storyteller publish output/narrative-week-{date}-final.md \
  --mode repo \
  --description "Weekly report: {date}"
```

Requires `GITHUB_TOKEN` in `.env` — see the publish-to-github skill.

---

## Daily Variation

Run at the end of each workday to keep a rolling log:

```bash
uv run storyteller run --period day
```

Then at week's end, run `--period week` to pull everything together.

## Required `.env` settings

```env
STORYTELLER_DATA_DIR=/path/to/your/data     # where session files + git repos live
STORYTELLER_OUTPUT_DIR=output/              # where generated files are written
GITHUB_TOKEN=ghp_...                        # for publishing
```

See `.env.example` for the full list of options.

## Output files at a glance

| File | Generated by | Used by |
|------|-------------|---------|
| `output/ingested.json` | `ingest` (step 1) | all subsequent steps |
| `output/digest-{period}-{date}.md` | `digest` (step 1) | Copilot narrative agent |
| `output/narrative-{period}-{date}.md` | `prepare` (step 1) | Copilot narrative agent |
| `output/narrative-{period}-{date}-final.md` | Copilot Chat (step 2) | `publish` (step 3) |

## Skills referenced

| Skill | Role |
|-------|------|
| `ingest-data` | Parses raw data sources into structured JSON |
| `digest` | Caches focused Copilot + git activity summary |
| `summarize-period` | Prepares time-bounded narrative context |
| `generate-narrative` | Copilot crafts the final narrative |
| `publish-to-github` | Publishes the finished markdown to GitHub |
